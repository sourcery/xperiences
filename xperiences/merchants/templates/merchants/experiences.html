{% extends 'base.html' %}

{% load x_tags %}

{% block content %}
<div class="main-content">
        <div class="command-bar-container">
            <div class="command-bar">
            <ul>
                <li><a href="/experiences/add_experience">Add new listing</a></li>
                <li><a href="/merchants/experiences">View all your listings</a></li>
                <li><a href="/merchants/inbox">Inbox</a></li>
                <li><a href="/merchants/account">Account</a></li>
            </ul>
        </div>
        </div>
        <div class="listings-container">
            <ul class="listings"></ul>
        </div><!-- closing listings-container -->
</div><!-- closing main-content -->
{% endblock %}


{% block hidden_templates %}
<script type='text/x_jquery_tempaltes' id='experience_item_template'>
    <li id="#" class="listing-item">
        <a class="#" title=" {% t_var title %}" href="{% t_url merchant_edit_experience slug_id %}">
            <img width="310" height="207" alt="{% t_var title %}" {% t_if photo1 %}src="{% t_var photo1.url %}"{% t_endif %}>
        </a>
        <div id="thumb-details">
            <p class="listing-title">
                <a title="{% t_var title %}" href="{% t_url merchant_edit_experience slug_id %}"> {% t_var title %} </a>
            </p>
            <p class="listing-merchant">
                <a title="{% t_var merchant.name %}" href=""> {% t_var merchant.name %}, {% t_var merchant.city %} {% t_var merchant.state %}</a>
            </p>
            <p class="listing-price">
                <span class="currency-symbol">$</span>
                {% t_var price %}
                <span class="currency-code"></span>
            </p>
        </div>
        Active: <input type=checkbox value='{% t_var is_active %}' {% t_if is_active %}checked='checked'{% t_endif %} onchange='update_status(this,"{% t_var id %}");' />
    </li>
</script>
{% endblock %}


{% block extra_scripts %}
<script type='text/javascript' >
var _merchant_id = '{{ merchant.id }}';
function get_experiences(params) {
    params = params || {};
    $.get('/api/experiences/json', params, render);
}


function render(data) {
    var items = $("#experience_item_template").tmpl(data);
    items.appendTo("ul.listings");
}


$(document).ready(function(){
    get_experiences({"merchant": _merchant_id });
});
</script>
{% endblock %}
